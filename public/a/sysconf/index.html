<style>
    .layui-form-mid{padding:0!important;}
    .layui-form-mid code{color:#5FB878;}
    .layui-table{color: #333!important}
</style>
<div class="layui-card">
    <div class="layui-tab layui-tab-brief layui-tab-vertical">
        <ul class="layui-tab-title" id="groupList">
            <span class="layui-tab-vertical-btn">
                <div class="layui-row">
                    <div class="layui-col-lg6 layui-col-md6 layui-col-xs6">
                        <div style="text-align: center">
                            <button class="layui-btn layui-btn-normal layui-btn-xs add-group">+分组</button>
                        </div>
                    </div>
                    <div class="layui-col-lg6 layui-col-md6 layui-col-xs6">
                        <div style="text-align: center">
                            <button class="layui-btn layui-btn-normal layui-btn-xs add-config">+配置</button>
                        </div>
                    </div>
                </div>
            </span>
        </ul>
        <div class="layui-tab-content">
            <div class="layui-tab-item layui-show" id="configContent">

            </div>
        </div>
    </div>
</div>

<script type="text/javascript" src="/static/a/js/sysconf.js" charset="utf-8"></script>

<script type="text/html" id="configTemplate">
    <form class="page-list-form layui-form" action="admin/sysconf/set">
        <input type="hidden" name="group" id="group" value="{{d.group}}" />
        <table class="layui-table" style="margin: 0;" lay-skin="nob">
            <colgroup>
                <col width="15%">
                <col width="40%">
                <col width="40%">
                <col width="5%">
            </colgroup>
            <tbody>
            {{# let k; }}
            {{# for(k in d.list){ }}
            <tr id="item-{{d.list[k].id}}">
                <td style="text-align:right;">
                    {{d.list[k].name}}
                </td>
                <td>
                    {{# if(d.list[k].type === "input"){ }}
                    <input type="text" name="{{d.list[k].key}}" class="layui-input" value="{{d.list[k].value}}" />
                    {{# }else if(d.list[k].type === "textarea"){ }}
                    <textarea name="{{d.list[k].key}}" class="layui-textarea">{{d.list[k].value}}</textarea>
                    {{# }else if(d.list[k].type === "select_single"){ }}
                    <select name="{{d.list[k].key}}">
                        <option value="">请选择</option>
                        {{# if(d.list[k].content){ }}
                            {{# let contentJson = JSON.parse(d.list[k].content); }}
                            {{# let content_k; }}
                            {{# for(content_k in contentJson){ }}
                            <option value="{{contentJson[content_k].value}}" {{# if(d.list[k].value === contentJson[content_k].value){ }}selected="selected"{{# } }}>{{contentJson[content_k].text}}</option>
                            {{# } }}
                        {{# } }}
                    </select>
                    {{# }else if(d.list[k].type === "select_multi"){ }}
                        {{# let num=0,content_k,dataSource = [],dataSelected = []; }}
                        {{# let contentJson = JSON.parse(d.list[k].content); }}
                        {{# for(content_k in contentJson){ }}
                            {{# dataSource.push("{name:'" + contentJson[content_k]["text"] + "',value:'" + contentJson[content_k]["value"] + "'}"); }}
                            {{# dataSelected.push(contentJson[content_k]["value"]); }}
                        {{# } }}
                    <div class="xm-select"
                         data-name="{{d.list[k].key}}"
                         data-type="data"
                         data-source="[{{dataSource}}]"
                         data-selected="[{{d.list[k].value}}]"
                    ></div>
                    {{# }else if(d.list[k].type === "switch"){ }}
                        {{# let num=0,content_k,closeText,closeValue,openText,openValue; }}
                        {{# let contentJson = JSON.parse(d.list[k].content); }}
                        {{# for(content_k in contentJson){ }}
                            {{# if(num===0){ }}
                                {{# closeText=contentJson[content_k]["text"]; }}
                                {{# closeValue=contentJson[content_k]["value"]; }}
                            {{# }else{ }}
                                {{# openText=contentJson[content_k]["text"]; }}
                                {{# openValue=contentJson[content_k]["value"]; }}
                            {{# } }}
                            {{# num++; }}
                        {{# } }}
                    <!-- 隐藏域设置开关未选中时需要传递的参数值 -->
                    <input type="hidden" name="{{d.list[k].key}}" value="{{closeValue}}" />
                    <input type="checkbox" name="{{d.list[k].key}}" lay-skin="switch"
                           lay-text="{{openText}}|{{closeText}}"
                           value="{{openValue}}"
                           {{# if(d.list[k].value === content_k){ }}checked="checked"{{# } }} />
                    {{# }else if(d.list[k].type === "image_single"){ }}
                    <div class="layTpUpload"
                         data-id="{{d.list[k].key}}"
                         data-name="{{d.list[k].key}}"
                         data-type="image_single"
                         data-width="640px"
                         data-height="400px"
                    ></div>
                    {{# } }}
                </td>
                <td>
                    <div class="layui-form-mid layui-word-aux">
                        {{d.list[k].tip}}
                        <br />
                        调用方式<code>Config::get('laytp.{{d.list[k].group}}.{{d.list[k].key}}')</code>
                    </div>
                </td>
                <td>
                    {{# if(!layui.facade.inArray(d.list[k].group+"."+d.list[k].key,["basic.siteName","basic.loginCaptcha","basic.firstMenuNum","upload.domain","upload.maxsize","upload.mimeType","upload.switch"])){ }}
                    <a href="javascript:void(0);" data-id="{{d.list[k].id}}" class="layui-btn layui-btn-primary layui-btn-sm layui-icon layui-icon-delete delete-config" layer-tips="删除" title="删除">删除</a>
                    {{# } }}
                </td>
            </tr>
            {{# } }}
            </tbody>
        </table>
        <div class="layui-input-block">
            <button class="layui-btn layui-btn-normal layui-btn-sm" lay-filter="laytp-form" lay-submit>提 交</button>
            {{# if(!layui.facade.inArray(d.group,["basic","upload"])){ }}
            <a class="layui-btn layui-btn-danger layui-btn-sm delete-group">删除分组</a>
            {{# } }}
        </div>
    </form>
</script>