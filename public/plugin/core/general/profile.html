<div class="page-tab-content">
    <style type="text/css">
        .layui-form-item .layui-form-label {
            width: 130px;
            text-align: right;
        }

        .layui-form-item .layui-input-inline {
            max-width: 80%;
            width: auto;
            min-width: 260px;
        }
    </style>
    <form class="layui-form" style="margin-top: 10px;">
        <div class="layui-form-item">
            <label class="layui-form-label">用户名</label>
            <div class="layui-inline layui-input-inline">
                <input type="text" name="username" id="username" lay-verify="required" lay-verType="tips"
                       placeholder="请输入用户名" autocomplete="off" class="layui-input"/>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">昵称</label>
            <div class="layui-inline layui-input-inline">
                <input type="text" name="nickname" id="nickname" lay-verify="required" lay-verType="tips"
                       placeholder="请输入昵称" autocomplete="off" class="layui-input"/>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">密码</label>
            <div class="layui-inline layui-input-inline">
                <input type="password" name="password" id="password" placeholder="请输入密码，留空为不修改密码" autocomplete="off"
                       class="layui-input"/>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">重复密码</label>
            <div class="layui-inline layui-input-inline">
                <input type="password" name="re_password" id="re_password" placeholder="请输入密码，留空为不修改密码"
                       autocomplete="off" class="layui-input"/>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" title="头像">头像</label>
            <div class="layui-input-block">
                <div class="layui-upload">
                    <div class="layTpUpload"
                         data-name="avatar"
                         data-accept="image"
                         data-width="400"
                         data-inputWidth="260px"
                         data-layVerify="required"
                    ></div>
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label"> </label>
            <div class="layui-input-block">
                <button class="layui-btn layui-btn-default" lay-submit lay-filter="laytp-profile">提 交</button>
            </div>
        </div>
    </form>
</div>
<script>
    layui.use(["layTp"], function () {
        $("#username").val(user.username);
        $("#nickname").val(user.nickname);
        $(".layTpUpload").data("uploaded", user.avatar);

        layui.form.on("submit(laytp-profile)", function (data) {
            layui.facade.ajax({
                path: "plugin/core/general/profile",
                params: data.field,
                method: "POST",
                async: false
            }).done(function (res) {
                if (res.code === 0) {
                    //渲染用户信息
                    $(".layui-nav-img").attr("src", data.field.avatar);
                    $(".laytp-nickname").html(data.field.nickname);
                    $(".img-circle").attr("src", data.field.avatar);
                    $(".laytp-nickname").html(data.field.nickname);
                }
            });
            return false;
        });
    });
</script>