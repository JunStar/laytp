<div class="recycle-page-tab-content">
    <div class="layui-tab-content">
        <div class="search-form-page-tab-content" id="recycle-search-form" style="display:none;">
            <form class="layui-form" style="margin-bottom:0px;">
                <div class="layui-row margin-bottom6">
                    <div class="layui-col-md4 layui-col-sm4 layui-col-xs4">
                        <label class="layui-form-label" title="ID">ID</label>
                        <div class="layui-input-block">
                            <input type="text" name="search_param[id][value]" id="id" placeholder="请输入ID"
                                   class="layui-input" autocomplete="off">
                            <input type="hidden" name="search_param[id][condition]" value="=">
                        </div>
                    </div>

                    <div class="layui-col-md4 layui-col-sm4 layui-col-xs4">
                        <label class="layui-form-label" title="角色名">角色名</label>
                        <div class="layui-input-block">
                            <input type="text" name="search_param[name][value]" id="username" placeholder="请输入角色名"
                                   class="layui-input" autocomplete="off">
                            <input type="hidden" name="search_param[name][condition]" value="LIKE">
                        </div>
                    </div>

                    <div class="layui-col-md4 layui-col-sm4 layui-col-xs4 search-btn">
                        <div class="layui-input-block">
                            <button class="layui-btn layui-btn-default layui-btn-sm layui-icon layui-icon-search"
                                    lay-submit
                                    lay-filter="laytp-recycle-search-form"> 确 定
                            </button>
                            <a class="layui-btn layui-btn-sm layui-btn-primary layui-icon layui-icon-refresh laytp-recycle-search-form-reset">
                                重 置</a>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <table id="laytp-recycle-table" lay-filter="laytp-recycle-table"></table>
    </div>
</div>

<script type="text/html" id="recycle-toolbar">
    {{#
    if(
    facade.hasAuth(apiPrefix + "restore")
    || facade.hasAuth(apiPrefix + "trueDel")
    ){
    }}
    <div class="dropdown-menu">
        <button class="layui-btn layui-btn-danger layui-btn-sm layui-icon layui-icon-drop">&nbsp;批量操作</button>
        <ul class="dropdown-menu-nav layui-anim-upbit dropdown-bottom-left layui-anim">
            <div class="dropdown-anchor"></div>
            {{# if(facade.hasAuth(apiPrefix + "restore")){ }}
            <li><a lay-event="restore"><i class="fa fa-history"></i>还原</a></li>
            {{# } }}
            {{# if(facade.hasAuth(apiPrefix + "trueDel")){ }}
            <li><a lay-event="trueDel"><i class="layui-icon layui-icon-delete"></i>删除</a></li>
            {{# } }}
        </ul>
    </div>
    {{# } }}
    <a class="layui-btn layui-btn-normal layui-btn-sm layui-icon layui-icon-search"
       lay-event="show-hidden-recycle-search-form">&nbsp;展开搜索
    </a>
</script>

<script type="text/html" id="recycle-operation">
    <div class="layui-btn-group">
        {{# if(facade.hasAuth(apiPrefix + "restore")){ }}
        <a class="layui-btn layui-btn-normal layui-btn-xs" lay-event="restore"><span class="fa fa-history"></span>
            还原
        </a>
        {{# } }}
        {{# if(facade.hasAuth(apiPrefix + "trueDel")){ }}
        <a class="layui-btn layui-btn-danger layui-btn-xs layui-icon layui-icon-delete" lay-event="trueDel"> 删除
        </a>
        {{# } }}
    </div>
</script>

<script type="text/javascript">
    layui.use(['layTp'], function () {
        const
            funRecycleController = {}
            , layTp = layui.layTp
            , facade = layui.facade
            , layTpForm = layui.layTpForm
        ;

        //表格渲染
        funRecycleController.tableRender = function (where, page) {
            layui.table.render({
                elem: "#laytp-recycle-table"
                , id: controller + "recycle"
                , url: facade.url(apiPrefix + "recycle")
                , where: where
                , method: "POST"
                , toolbar: "#recycle-toolbar"
                , even: true
                , loading: false
                , page: {
                    theme: "var(--laytp-layui-laypage-em)"
                    , curr: page
                }
                , parseData: function (res) {
                    return {
                        "code": res.code, //解析接口状态
                        "msg": res.msg, //解析提示文本
                        "count": res.data.total, //解析数据长度
                        "data": res.data.data //解析数据列表
                    };
                }
                , cols: [[ //表头
                    {type: "checkbox"}
                    , {field: "id", title: "ID", align: "center", width: 80}
                    , {field: "name", title: "角色名"}
                    , {
                        field: "operation",
                        title: "操作",
                        toolbar: "#recycle-operation",
                        fixed: "right",
                        align: "center",
                        width: 140
                    }
                ]]
            });

            //监听数据表格顶部左侧按钮点击事件
            layui.table.on('toolbar(laytp-recycle-table)', function (obj) {
                //默认按钮点击事件，包括添加按钮和回收站按钮
                if (defaultTableToolbar.indexOf(obj.event) !== -1) {
                    layTp.tableToolbar(obj);
                    //其他自定义按钮点击事件
                } else {
                    // //自定义按钮点击事件
                    // switch(obj.event){
                    // //自定义按钮点击事件
                    // case '':
                    //
                    //     break;
                    // }
                }
            });

            //监听数据表格[操作列]按钮点击事件
            layui.table.on('tool(laytp-recycle-table)', function (obj) {
                if (defaultTableTool.indexOf(obj.event) !== -1) {
                    layTp.tableTool(obj);
                } else {
                    //自定义按钮
                    // switch(obj.event){
                    // case '':
                    //
                    //     break;
                    // }
                }
            });
        };

        funRecycleController.tableRender();

        window.funRecycleController = funRecycleController;
    });
</script>